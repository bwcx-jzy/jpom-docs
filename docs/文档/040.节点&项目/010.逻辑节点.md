---
title: 逻辑节点
date: 2024-01-14 18:32:42
permalink: /pages/285484/
categories:
  - docs
  - 文档
  - 节点&项目
tags:
  - 
---

## 前言

逻辑节点是指物理集群安装 Jpom 插件端后并且添加到资产管理中再分配到工作空间的机器节点，

像`节点项目`、`节点脚本`均是绑定在逻辑节点上的

:::tip 提醒
逻辑节点是在工作空间之下奥，得先有工作空间才能分配资产机器为逻辑节点，**那么删除资产机器时需要保证资产机器下未分配逻辑节点才能删除奥**
:::

## 新增逻辑节点

新增逻辑节点有如下几种方式，请自行根据实际情况选择操作

- 资产机器分配新增
- 快速安装自动新增
- 跨工作空间同步新增

### 资产机器分配

资产机器分配时指您先在服务器中安装插件端后并且添加到【系统管理】中的【资产机器】中，然后手动分配到当前工作空间

资产机器操作说明请查看[资产机器说明文档](/pages/3f268f/)


![机器列表分配](/images/assets/31d5506932705733c51feed3b71db5af.png)


![机器分配](/images/assets/c18d198563197365ebabc72a7826348e.png)

这样操作后您就可以将对应资产信息分配到相应的工作空间的【逻辑节点】使用啦。

我们回到【功能管理】里面去看看效果。

![逻辑节点列表](/images/assets/f43821866d901809d9eaff101a6bdae3.png)


### 快速安装

快速安装是指您机器中还没有安装插件端，使用安装脚本来自动安装插件端并添加【资产机器】再自动分配【逻辑节点】

:::tip 前提
仅 Linux 系统支持快速安装、您节点服务器中有公网能下载文件

-------

节点服务器能访问服务端的端口（服务端端口默认：2122）

------

安装操作过程中不建议您关闭弹窗，因为安装机器结果会轮询并展示到弹窗【执行结果】中

------

如果失败请不要灰心，您可以使用资产管理中新增机器节点来逐步添加
:::

使用此功能时请仔细阅读【温馨提示】/【注意事项】

![Alt text](/images/node/use/image.png)

按照提示分为快速安装和快速绑定：快速安装时指您还未安装插件端、快速绑定是指您以及安装插件端但是未添加到服务端中的资产机器中（请根据实际情况选择）

执行命令后您可能有如下几种结果：（**由于情况太多，本文就不一一复现并截图请根据下述类型对照排查**）

#### 安装失败

请根据安装脚本输出的日志自行排查

脚本安装可以参考：[一键安装（linux）](/pages/fe28e9/)

#### 向服务端推送注册失败

如果您在执行安装脚本中查看到控制台有类似日志输出：此情况一般是网络不可达或者程序错误，如果是网络问题您需要自行检查插件端服务器是否可以访问服务端服务器（防火墙、安全组等）

#### 不能和节点正常通讯

如果您在安装弹窗【执行结果】中看到有类似状态表示：插件端安装成功向服务端推送了自身信息但是服务端去反向访问插件端时网络不可达，此时您需要排查插件端所在服务器的：防火墙、安全组等了网络限制

#### 多IP可以使用

如果您在安装弹窗【执行结果】中看到有类似状态表示：插件端安装成功向服务端推送他自身可用的 IP 地址时，服务端发现有多个可用 IP 时考虑到不同网络 IP 可能有不同特点，需要您手动确认使用哪个 IP 让服务器和插件端进行通信

![Alt text](/images/node/use/image-1.png)

#### 节点已经存在

如果您在安装弹窗【执行结果】中看到有类似状态表示：插件端安装成功并向服务端推送成功，但是发现已经存在对应的机器信息并且节点也存在啦，无需重复操作

#### 绑定成功

如果您在安装弹窗【执行结果】中看到有类似状态表示：插件端安装成功也向服务端推送成功并且一切顺利执行，机器节点、逻辑节点均正常新增

看到此结果您可以先关闭弹窗查看对应节点信息是否正确，确认后我们建议您再次打卡弹窗，将对应安装和绑定记录缓存手动清除掉（当然您可以不操作，因为重启服务端后自动失效）

![Alt text](/images/node/use/image-2.png)


### 工作空间同步

工作空间同步指您已经存在一个逻辑节点啦，但是想快速将此节点同步或者分配到其他工作空间

您有两种方式：

- 管理员资产机器中分配
- 普通用户工作空间同步

#### 管理员分配

需要到【资产管理】->【机器管理】手动分配

#### 普通用户同步

普通用户可以将他有权限的工作空间下的逻辑节点同步到他有权限的其他工作空间下

![Alt text](/images/node/use/image-3.png)

![Alt text](/images/node/use/image-4.png)

## 节点管理

节点管理是可以统一查看当前逻辑节点（逻辑节点+工作空间）下面关联的关联的项目数据、脚本数据、脚本日志

![Alt text](/images/node/use/image-11.png)


### 项目管理

> 项目管理的具体说明请查阅项目管理的文档

![Alt text](/images/node/use/image-12.png)

### 脚本管理

> 脚本管理（节点脚本）的具体说明请查阅节点脚本管理的文档

![Alt text](/images/node/use/image-13.png)

### 脚本日志

> 脚本日志（节点脚本日志）的具体说明请查阅节点脚本日志管理的文档

![Alt text](/images/node/use/image-14.png)

## 节点监控

普通用户可以通过逻辑节点查看到逻辑节点对应的机器的资源信息（数据来源资产监控）

查看方式：逻辑节点中切换为卡片视图

![Alt text](/images/node/use/image-5.png)

![Alt text](/images/node/use/image-6.png)

## 节点终端

节点终端是指您可以将当前工作空间下的一个 SSH 与逻辑节点做一个关系绑定，用户快速登录到机器的 SSH 终端

![Alt text](/images/node/use/image-7.png)

![Alt text](/images/node/use/image-8.png)

:::danger 提醒
此绑定仅是一个逻辑绑定，最终绑定的 SSH 机器是否和逻辑节点的机器是否一致是不会判断的

---------

删除工作空间下的 SSH 时候需要先与逻辑节点解绑才能删除
:::

![Alt text](/images/node/use/image-9.png)


![Alt text](/images/node/use/image-10.png)

## 节点缓存

节点缓存是由于节点的项目数据、脚本数据、脚本日志数据最终均存储在机器节点中，服务端会主动同步过来。有时候可能缓存不一致的情况此时就需要手动同步一次来达到缓存一致的问题

查看节点项目缓存

![Alt text](/images/node/use/image-15.png)

通过悬停可以看到机器节点和逻辑节点的项目具体数量

:::danger 关系说明
关联绑定为：项目=逻辑节点ID+工作空间ID

-------

逻辑节点=机器ID+工作空间ID

-------

一些极端情况关联绑定错误会形成孤独数据：孤独数据管理请查阅【机器节点】->【缓存监控】->【孤独数据】中引导操作

------ 

如果发现项目找不到了（未主动删除的情况、新增提示路径占用合作存在请参考孤独数据解决方案）

:::

![Alt text](/images/node/use/image-16.png)

## 删除节点

如果您想删除节点那么您需要检查逻辑节点是否还存在关联数据：

- 节点项目
- 节点脚本
- 节点分发
- 日志阅读
- 项目监控
- 在线构建（分发方式为节点项目）

:::danger 操作提示
删除逻辑节点会通知机器节点，如果您机器节点已经无法访问（资源过期、关闭机器）请使用解绑
:::


:::tip 温馨提醒
删除时候如果提示还存在 xxxx 关联数据请耐心检查核对，不要操之过急
:::

![Alt text](/images/node/use/image-17.png)

![Alt text](/images/node/use/image-18.png)

## 解绑节点

如果您想删除逻辑节点但是机器节点已经未使用或者不能使用（云服务器资源过期、资源分配释放等各种原因）您可以使用解绑节点

但是解绑节点仍然会检查数据关联性：

- 节点分发
- 日志阅读
- 项目监控
- 在线构建（分发方式为节点项目）


您仍然需要先删除关联数据

:::danger 数据风险
解绑不会判断：节点项目、节点脚本（请慎重操作避免产生冗余数据）
:::


![Alt text](/images/node/use/image-19.png)

![Alt text](/images/node/use/image-20.png)

## 节点排序

节点排序，如果您单个工作空间下节点过多，但是有部分为高频节点，有部分为低频节点可以使用此功能（不过我们还是建议您合理分配工作空间）

### 置顶、下移、下移

![Alt text](/images/node/use/image-21.png)

![Alt text](/images/node/use/image-22.png)

![Alt text](/images/node/use/image-23.png)
